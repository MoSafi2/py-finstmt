from typing import Dict

import pandas as pd
from pandas.testing import assert_series_equal

from finstmt import FinancialStatements, IncomeStatements, BalanceSheets


class LoadTest:
    a_test_data_dict: Dict[str, pd.Series]
    q_test_data_dict: Dict[str, pd.Series]

    def test_annual(self, stmts: FinancialStatements):
        raise NotImplementedError

    def test_quarterly(self, stmts: FinancialStatements):
        raise NotImplementedError

    def check_data_items(self, stmts: FinancialStatements, data_dict: Dict[str, pd.Series]):
        for item_key, item_values in data_dict.items():
            item = getattr(stmts, item_key)
            assert_series_equal(item, item_values)



class TestLoadStockrow(LoadTest):
    a_index_str = ["2009-12-31 00:00:00", "2010-12-31 00:00:00", "2011-12-31 00:00:00", "2012-12-31 00:00:00",
                   "2013-12-31 00:00:00", "2014-12-31 00:00:00", "2015-12-31 00:00:00", "2016-12-31 00:00:00",
                   "2017-12-31 00:00:00", "2018-12-31 00:00:00"]
    a_index = [pd.to_datetime(val) for val in a_index_str]
    a_test_data_dict = dict(
        revenue=pd.Series(
            [32396000000.0, 42588000000.0, 60138000000.0, 65875000000.0, 55656000000.0, 55184000000.0, 47011000000.0,
             38537000000.0, 45462000000.0, 54722000000.0],
            index=a_index
        ),
        cogs=pd.Series(
            [24931000000.0, 31281000000.0, 44404000000.0, 47852000000.0, 41454000000.0, 41342000000.0, 34133000000.0,
             28640000000.0, 31906000000.0, 37719000000.0],
            index=a_index
        ),
        gross_profit=pd.Series(
            [7465000000.0, 11307000000.0, 15734000000.0, 18023000000.0, 14202000000.0, 13842000000.0, 12878000000.0,
             9897000000.0, 13556000000.0, 17003000000.0],
            index=a_index
        ),
        rd_exp=pd.Series(
            [1421000000.0, 1905000000.0, 2297000000.0, 2466000000.0, 2046000000.0, 2380000000.0, 2119000000.0,
             1853000000.0, 1842000000.0, 1850000000.0],
            index=a_index
        ),
        sga=pd.Series(
            [3645000000.0, 4248000000.0, 5203000000.0, 5919000000.0, 5547000000.0, 6529000000.0, 4951000000.0,
             4383000000.0, 4999000000.0, 5478000000.0],
            index=a_index
        ),
        dep_exp=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            index=a_index
        ),
        other_op_exp=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            index=a_index
        ),
        op_exp=pd.Series(
            [6888000000.0, 7344000000.0, 8581000000.0, 9450000000.0, 8574000000.0, 10528000000.0, 9093000000.0,
             8735000000.0, 9096000000.0, 8710000000.0],
            index=a_index
        ),
        ebit=pd.Series(
            [1014000000.0, 4011000000.0, 7044000000.0, 8676000000.0, 5573000000.0, 3628000000.0, 3935000000.0,
             630000000.0, 4624000000.0, 8249000000.0],
            index=a_index
        ),
        int_exp=pd.Series(
            [389000000.0, 343000000.0, 396000000.0, 467000000.0, 465000000.0, 484000000.0, 507000000.0, 505000000.0,
             531000000.0, 404000000.0],
            index=a_index
        ),
        gain_on_sale_invest=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            index=a_index
        ),
        gain_on_sale_asset=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            index=a_index
        ),
        impairment=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            index=a_index
        ),
        ebt=pd.Series(
            [625000000.0, 3668000000.0, 6648000000.0, 8209000000.0, 5108000000.0, 3144000000.0, 3428000000.0,
             125000000.0, 4093000000.0, 7845000000.0],
            index=a_index
        ),
        tax_exp=pd.Series(
            [270000000.0, 968000000.0, 1720000000.0, 2528000000.0, 1319000000.0, 692000000.0, 916000000.0, 192000000.0,
             3339000000.0, 1698000000.0],
            index=a_index
        ),
        net_income=pd.Series(
            [895000000.0, 2700000000.0, 4928000000.0, 5681000000.0, 3789000000.0, 2452000000.0, 2512000000.0,
             67000000.0, 754000000.0, 6147000000.0],
            index=a_index
        ),
        cash=pd.Series(
            [4867000000, 3592000000, 3057000000, 5490000000, 6081000000, 7341000000, 6460000000, 7168000000, 8261000000,
             7857000000],
            index=a_index
        ),
        st_invest=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            index=a_index
        ),
        cash_and_st_invest=pd.Series(
            [4867000000, 3592000000, 3057000000, 5490000000, 6081000000, 7341000000, 6460000000, 7168000000, 8261000000,
             7857000000],
            index=a_index
        ),
        receivables=pd.Series(
            [27162000000, 28849000000, 30803000000, 33911000000, 33499000000, 32772000000, 30507000000, 29088000000,
             30725000000, 31899000000],
            index=a_index
        ),
        inventory=pd.Series(
            [6360000000, 9587000000, 14544000000, 15547000000, 12625000000, 12205000000, 9700000000, 8614000000,
             10018000000, 11529000000],
            index=a_index
        ),
        def_tax_st=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            index=a_index
        ),
        other_current_assets=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            index=a_index
        ),
        total_current_assets=pd.Series(
            [27217000000, 31810000000, 37900000000, 42138000000, 38335000000, 38867000000, 33508000000, 31967000000,
             36244000000, 38603000000],
            index=a_index
        ),
        gross_ppe=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            index=a_index
        ),
        dep=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            index=a_index
        ),
        net_ppe=pd.Series(
            [12386000000, 12539000000, 14395000000, 16461000000, 17075000000, 16577000000, 16090000000, 15322000000,
             14155000000, 13574000000],
            index=a_index
        ),
        goodwill=pd.Series(
            [2734000000, 3419000000, 11448000000, 10958000000, 10552000000, 9770000000, 9436000000, 8369000000,
             8311000000, 8114000000],
            index=a_index
        ),
        lt_invest=pd.Series(
            [105000000, 164000000, 133000000, 272000000, 272000000, 257000000, 0, 0, 0, 0],
            index=a_index
        ),
        def_tax_lt=pd.Series(
            [3930000000, 3424000000, 3737000000, 3558000000, 2147000000, 3143000000, 2489000000, 2790000000, 1693000000,
             1439000000],
            index=a_index
        ),
        other_lt_assets=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            index=a_index
        ),
        total_non_current_assets=pd.Series(
            [32821000000, 32210000000, 43318000000, 46832000000, 46561000000, 45814000000, 44834000000, 42737000000,
             40718000000, 39906000000],
            index=a_index
        ),
        total_assets=pd.Series(
            [60038000000, 64020000000, 81218000000, 88970000000, 84896000000, 84681000000, 78342000000, 74704000000,
             76962000000, 78509000000],
            index=a_index
        ),
        payables=pd.Series(
            [2993000000, 5856000000, 8161000000, 6753000000, 6560000000, 6515000000, 5023000000, 4614000000, 6487000000,
             7051000000],
            index=a_index
        ),
        st_debt=pd.Series(
            [9784000000, 7981000000, 9648000000, 12391000000, 11031000000, 11501000000, 12844000000, 13965000000,
             11031000000, 11553000000],
            index=a_index
        ),
        current_lt_debt=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            index=a_index
        ),
        tax_liab_st=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            index=a_index
        ),
        other_current_liab=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            index=a_index
        ),
        total_current_liab=pd.Series(
            [18975000000, 22020000000, 28357000000, 29415000000, 27297000000, 27877000000, 26242000000, 26132000000,
             26931000000, 28218000000],
            index=a_index
        ),
        lt_debt=pd.Series(
            [21847000000, 20437000000, 24944000000, 27752000000, 26719000000, 27784000000, 25169000000, 22818000000,
             23847000000, 25000000000],
            index=a_index
        ),
        total_debt=pd.Series(
            [31631000000, 28418000000, 34592000000, 40143000000, 37750000000, 39285000000, 38013000000, 36783000000,
             34878000000, 36553000000],
            index=a_index
        ),
        deferred_rev=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            index=a_index
        ),
        tax_liab_lt=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            index=a_index
        ),
        deposit_liab=pd.Series(
            [1217000000, 1831000000, 2487000000, 2638000000, 2360000000, 1697000000, 1146000000, 1167000000, 1426000000,
             1243000000],
            index=a_index
        ),
        other_lt_liab=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            index=a_index
        ),
        total_non_current_liab=pd.Series(
            [31763000000, 30675000000, 39459000000, 41973000000, 36721000000, 39978000000, 37215000000, 35359000000,
             36265000000, 36211000000],
            index=a_index
        ),
        total_liab=pd.Series(
            [50738000000, 52695000000, 67816000000, 71388000000, 64018000000, 67855000000, 63457000000, 61491000000,
             63196000000, 64429000000],
            index=a_index
        ),
        common_stock=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            index=a_index
        ),
        other_income=pd.Series(
            [-3764000000, -4051000000, -6328000000, -6433000000, -3898000000, -6431000000, -2035000000, -2039000000,
             -1192000000, -1684000000],
            index=a_index
        ),
        retained_earnings=pd.Series(
            [19711000000, 21384000000, 25219000000, 29558000000, 31854000000, 33887000000, 29246000000, 27377000000,
             26301000000, 30427000000],
            index=a_index
        ),
        minority_interest=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            index=a_index
        ),
        total_equity=pd.Series(
            [8740000000, 10824000000, 12883000000, 17532000000, 20811000000, 16746000000, 14809000000, 13213000000,
             13766000000, 14080000000],
            index=a_index
        ),
        total_liab_and_equity=pd.Series(
            [59478000000.0, 63519000000.0, 80699000000.0, 88920000000.0, 84829000000.0, 84601000000.0, 78266000000.0,
             74704000000.0, 76962000000.0, 78509000000.0],
            index=a_index
        ),
    )

    q_index_str = ["2009-12-31 00:00:00", "2010-03-31 00:00:00", "2010-06-30 00:00:00", "2010-09-30 00:00:00",
                   "2010-12-31 00:00:00", "2011-03-31 00:00:00", "2011-06-30 00:00:00", "2011-09-30 00:00:00",
                   "2011-12-31 00:00:00", "2012-03-31 00:00:00", "2012-06-30 00:00:00", "2012-09-30 00:00:00",
                   "2012-12-31 00:00:00", "2013-03-31 00:00:00", "2013-06-30 00:00:00", "2013-09-30 00:00:00",
                   "2013-12-31 00:00:00", "2014-03-31 00:00:00", "2014-06-30 00:00:00", "2014-09-30 00:00:00",
                   "2014-12-31 00:00:00", "2015-03-31 00:00:00", "2015-06-30 00:00:00", "2015-09-30 00:00:00",
                   "2015-12-31 00:00:00", "2016-03-31 00:00:00", "2016-06-30 00:00:00", "2016-09-30 00:00:00",
                   "2016-12-31 00:00:00", "2017-03-31 00:00:00", "2017-06-30 00:00:00", "2017-09-30 00:00:00",
                   "2017-12-31 00:00:00", "2018-03-31 00:00:00", "2018-06-30 00:00:00", "2018-09-30 00:00:00",
                   "2018-12-31 00:00:00", "2019-03-31 00:00:00", "2019-06-30 00:00:00", "2019-09-30 00:00:00"]
    q_index = [pd.to_datetime(val) for val in q_index_str]
    q_test_data_dict = dict(
        revenue=pd.Series(
            [7898000000.0, 8238000000.0, 10409000000.0, 11134000000.0, 12807000000.0, 12949000000.0, 14230000000.0,
             15716000000.0, 17243000000.0, 15981000000.0, 17374000000.0, 16445000000.0, 16075000000.0, 13210000000.0,
             14621000000.0, 13423000000.0, 14402000000.0, 13241000000.0, 14150000000.0, 13549000000.0, 14244000000.0,
             12702000000.0, 12317000000.0, 10962000000.0, 11030000000.0, 9461000000.0, 10342000000.0, 9160000000.0,
             9574000000.0, 9822000000.0, 11331000000.0, 11413000000.0, 12896000000.0, 12859000000.0, 14011000000.0,
             13510000000.0, 14342000000.0, 13466000000.0, 14432000000.0, 12758000000.0],
            index=q_index
        ),
        cogs=pd.Series(
            [6090000000.0, 6127000000.0, 7606000000.0, 7979000000.0, 9569000000.0, 9260000000.0, 10512000000.0,
             11666000000.0, 12966000000.0, 11441000000.0, 12478000000.0, 11836000000.0, 12097000000.0, 9828000000.0,
             10958000000.0, 9952000000.0, 10716000000.0, 9597000000.0, 10350000000.0, 9791000000.0, 11604000000.0,
             8910000000.0, 8822000000.0, 8014000000.0, 8387000000.0, 6974000000.0, 7567000000.0, 6674000000.0,
             7425000000.0, 6960000000.0, 7978000000.0, 7841000000.0, 9127000000.0, 8732000000.0, 9604000000.0,
             9207000000.0, 10176000000.0, 9193000000.0, 10133000000.0, 8758000000.0],
            index=q_index
        ),
        gross_profit=pd.Series(
            [1808000000.0, 2111000000.0, 2803000000.0, 3155000000.0, 3238000000.0, 3689000000.0, 3718000000.0,
             4050000000.0, 4277000000.0, 4540000000.0, 4896000000.0, 4609000000.0, 3978000000.0, 3382000000.0,
             3663000000.0, 3471000000.0, 3686000000.0, 3644000000.0, 3800000000.0, 3758000000.0, 2640000000.0,
             3792000000.0, 3495000000.0, 2948000000.0, 2643000000.0, 2487000000.0, 2775000000.0, 2486000000.0,
             2149000000.0, 2862000000.0, 3353000000.0, 3572000000.0, 3769000000.0, 4127000000.0, 4407000000.0,
             4303000000.0, 4166000000.0, 4273000000.0, 4299000000.0, 4000000000.0],
            index=q_index
        ),
        rd_exp=pd.Series(
            [355000000.0, 402000000.0, 450000000.0, 510000000.0, 543000000.0, 525000000.0, 584000000.0, 584000000.0,
             604000000.0, 587000000.0, 632000000.0, 634000000.0, 613000000.0, 562000000.0, 548000000.0, 469000000.0,
             467000000.0, 508000000.0, 516000000.0, 533000000.0, 823000000.0, 524000000.0, 510000000.0, 513000000.0,
             572000000.0, 508000000.0, 468000000.0, 453000000.0, 424000000.0, 425000000.0, 458000000.0, 461000000.0,
             498000000.0, 443000000.0, 462000000.0, 479000000.0, 466000000.0, 435000000.0, 441000000.0, 431000000.0],
            index=q_index
        ),
        sga=pd.Series(
            [942000000.0, 932000000.0, 1059000000.0, 1148000000.0, 1109000000.0, 1099000000.0, 1257000000.0,
             1360000000.0, 1487000000.0, 1340000000.0, 1517000000.0, 1471000000.0, 1591000000.0, 1390000000.0,
             1421000000.0, 1319000000.0, 1417000000.0, 1292000000.0, 1437000000.0, 1446000000.0, 2354000000.0,
             1249000000.0, 1318000000.0, 1129000000.0, 1255000000.0, 1088000000.0, 1123000000.0, 992000000.0,
             1180000000.0, 1061000000.0, 1304000000.0, 1254000000.0, 1380000000.0, 1276000000.0, 1440000000.0,
             1299000000.0, 1463000000.0, 1319000000.0, 1309000000.0, 1251000000.0],
            index=q_index
        ),
        dep_exp=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 0, 0],
            index=q_index
        ),
        other_op_exp=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 0, 0],
            index=q_index
        ),
        op_exp=pd.Series(
            [1680000000.0, 1603000000.0, 1826000000.0, 1968000000.0, 1947000000.0, 1856000000.0, 2117000000.0,
             2291000000.0, 2317000000.0, 2217000000.0, 2280000000.0, 2013000000.0, 2940000000.0, 2164000000.0,
             2106000000.0, 2070000000.0, 2234000000.0, 2246000000.0, 2325000000.0, 2366000000.0, 3591000000.0,
             2090000000.0, 2162000000.0, 2023000000.0, 2818000000.0, 1993000000.0, 1990000000.0, 2005000000.0,
             2747000000.0, 2482000000.0, 2169000000.0, 2063000000.0, 2382000000.0, 2019000000.0, 2240000000.0,
             2168000000.0, 2283000000.0, 2066000000.0, 2086000000.0, 1980000000.0],
            index=q_index
        ),
        ebit=pd.Series(
            [229000000.0, 566000000.0, 997000000.0, 1172000000.0, 1276000000.0, 1824000000.0, 1423000000.0,
             1727000000.0, 2070000000.0, 2388000000.0, 2681000000.0, 2581000000.0, 1026000000.0, 1246000000.0,
             1467000000.0, 1372000000.0, 1488000000.0, 1450000000.0, 1538000000.0, 1509000000.0, 869000000.0,
             1895000000.0, 1262000000.0, 904000000.0, 126000000.0, 492000000.0, 864000000.0, 505000000.0, 1231000000.0,
             405000000.0, 1284000000.0, 1647000000.0, 1288000000.0, 2238000000.0, 2299000000.0, 2244000000.0,
             1468000000.0, 2371000000.0, 2288000000.0, 2115000000.0],
            index=q_index
        ),
        int_exp=pd.Series(
            [88000000.0, 102000000.0, 81000000.0, 85000000.0, 75000000.0, 87000000.0, 90000000.0, 112000000.0,
             107000000.0, 113000000.0, 110000000.0, 129000000.0, 115000000.0, 120000000.0, 120000000.0, 116000000.0,
             109000000.0, 110000000.0, 120000000.0, 128000000.0, 126000000.0, 129000000.0, 125000000.0, 127000000.0,
             126000000.0, 129000000.0, 130000000.0, 126000000.0, 120000000.0, 123000000.0, 121000000.0, 118000000.0,
             169000000.0, 101000000.0, 102000000.0, 102000000.0, 99000000.0, 103000000.0, 103000000.0, 103000000.0],
            index=q_index
        ),
        gain_on_sale_invest=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 0, 0],
            index=q_index
        ),
        gain_on_sale_asset=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 0, 0],
            index=q_index
        ),
        impairment=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 0, 0],
            index=q_index
        ),
        ebt=pd.Series(
            [141000000.0, 464000000.0, 916000000.0, 1087000000.0, 1201000000.0, 1737000000.0, 1333000000.0,
             1615000000.0, 1963000000.0, 2275000000.0, 2571000000.0, 2452000000.0, 911000000.0, 1126000000.0,
             1347000000.0, 1256000000.0, 1379000000.0, 1340000000.0, 1418000000.0, 1381000000.0, 995000000.0,
             1766000000.0, 1137000000.0, 777000000.0, 252000000.0, 363000000.0, 734000000.0, 379000000.0, 1351000000.0,
             282000000.0, 1163000000.0, 1529000000.0, 1119000000.0, 2137000000.0, 2197000000.0, 2142000000.0,
             1369000000.0, 2268000000.0, 2185000000.0, 2012000000.0],
            index=q_index
        ),
        tax_exp=pd.Series(
            [91000000.0, 231000000.0, 209000000.0, 295000000.0, 233000000.0, 512000000.0, 318000000.0, 474000000.0,
             416000000.0, 689000000.0, 872000000.0, 753000000.0, 214000000.0, 246000000.0, 387000000.0, 310000000.0,
             376000000.0, 418000000.0, 419000000.0, 364000000.0, 509000000.0, 521000000.0, 335000000.0, 218000000.0,
             158000000.0, 92000000.0, 184000000.0, 96000000.0, 180000000.0, 90000000.0, 361000000.0, 470000000.0,
             2418000000.0, 472000000.0, 490000000.0, 415000000.0, 321000000.0, 387000000.0, 565000000.0, 518000000.0],
            index=q_index
        ),
        net_income=pd.Series(
            [232000000.0, 233000000.0, 707000000.0, 792000000.0, 968000000.0, 1225000000.0, 1015000000.0, 1141000000.0,
             1547000000.0, 1586000000.0, 1699000000.0, 1699000000.0, 697000000.0, 880000000.0, 960000000.0, 946000000.0,
             1003000000.0, 922000000.0, 999000000.0, 1017000000.0, 486000000.0, 1245000000.0, 802000000.0, 559000000.0,
             94000000.0, 271000000.0, 550000000.0, 283000000.0, 1171000000.0, 192000000.0, 802000000.0, 1059000000.0,
             1299000000.0, 1665000000.0, 1707000000.0, 1727000000.0, 1048000000.0, 1881000000.0, 1620000000.0,
             1494000000.0],
            index=q_index
        ),
        cash=pd.Series(
            [4867000000, 3538000000, 3597000000, 2265000000, 3592000000, 4869000000, 10715000000, 3229000000,
             3057000000, 2864000000, 5103000000, 5689000000, 5490000000, 5982000000, 6110000000, 6357000000, 6081000000,
             5345000000, 7927000000, 6082000000, 7341000000, 7563000000, 7821000000, 6046000000, 6460000000, 5886000000,
             6764000000, 6113000000, 7168000000, 9472000000, 10232000000, 9591000000, 8261000000, 7888000000,
             8654000000, 8007000000, 7857000000, 7128000000, 7429000000, 7906000000],
            index=q_index
        ),
        st_invest=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 0, 0],
            index=q_index
        ),
        cash_and_st_invest=pd.Series(
            [4867000000, 3538000000, 3597000000, 2265000000, 3592000000, 4869000000, 10715000000, 3229000000,
             3057000000, 2864000000, 5103000000, 5689000000, 5490000000, 5982000000, 6110000000, 6357000000, 6081000000,
             5345000000, 7927000000, 6082000000, 7341000000, 7563000000, 7821000000, 6046000000, 6460000000, 5886000000,
             6764000000, 6113000000, 7168000000, 9472000000, 10232000000, 9591000000, 8261000000, 7888000000,
             8654000000, 8007000000, 7857000000, 7128000000, 7429000000, 7906000000],
            index=q_index
        ),
        receivables=pd.Series(
            [27162000000, 27070000000, 27169000000, 28250000000, 28849000000, 29348000000, 29997000000, 30034000000,
             30803000000, 31632000000, 32584000000, 33257000000, 33911000000, 34164000000, 33812000000, 33724000000,
             33499000000, 33889000000, 34190000000, 33176000000, 32772000000, 31588000000, 31413000000, 30462000000,
             30507000000, 30852000000, 30396000000, 29453000000, 29088000000, 29587000000, 29732000000, 29836000000,
             30725000000, 31029000000, 31299000000, 31171000000, 31899000000, 31716000000, 32150000000, 31072000000],
            index=q_index
        ),
        inventory=pd.Series(
            [6360000000, 6990000000, 7339000000, 9006000000, 9587000000, 10676000000, 11359000000, 14412000000,
             14544000000, 16511000000, 17344000000, 17550000000, 15547000000, 15074000000, 13889000000, 13392000000,
             12625000000, 12888000000, 13055000000, 13328000000, 12205000000, 12099000000, 11681000000, 11150000000,
             9700000000, 9849000000, 9458000000, 9478000000, 8614000000, 9082000000, 9388000000, 10212000000,
             10018000000, 10947000000, 11255000000, 11814000000, 11529000000, 12340000000, 12007000000, 12180000000],
            index=q_index
        ),
        def_tax_st=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 0, 0],
            index=q_index
        ),
        other_current_assets=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 0, 0],
            index=q_index
        ),
        total_current_assets=pd.Series(
            [27217000000, 26412000000, 27376000000, 28577000000, 31810000000, 34608000000, 40755000000, 36864000000,
             37900000000, 40209000000, 44294000000, 44639000000, 42138000000, 42145000000, 40805000000, 40088000000,
             38335000000, 37968000000, 41276000000, 39042000000, 38867000000, 38491000000, 38227000000, 35280000000,
             33508000000, 33748000000, 33606000000, 31999000000, 31967000000, 35548000000, 36991000000, 37185000000,
             36244000000, 37357000000, 38641000000, 38454000000, 38603000000, 39126000000, 39789000000, 39160000000],
            index=q_index
        ),
        gross_ppe=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 0, 0],
            index=q_index
        ),
        dep=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 0, 0],
            index=q_index
        ),
        net_ppe=pd.Series(
            [12386000000, 12057000000, 11763000000, 12065000000, 12539000000, 12219000000, 12430000000, 13397000000,
             14395000000, 14571000000, 14928000000, 15509000000, 16461000000, 16276000000, 16352000000, 16588000000,
             17075000000, 16716000000, 16690000000, 16431000000, 16577000000, 16277000000, 16136000000, 15955000000,
             16090000000, 15935000000, 15916000000, 15680000000, 15322000000, 14727000000, 14420000000, 14187000000,
             14155000000, 13912000000, 13752000000, 13607000000, 13574000000, 13259000000, 13172000000, 12842000000],
            index=q_index
        ),
        goodwill=pd.Series(
            [2734000000, 2772000000, 2777000000, 3458000000, 3419000000, 3402000000, 3385000000, 12307000000,
             11448000000, 11368000000, 11556000000, 11538000000, 10958000000, 10715000000, 10578000000, 10686000000,
             10552000000, 10495000000, 10367000000, 10011000000, 9770000000, 9383000000, 9413000000, 9387000000,
             9436000000, 9451000000, 9329000000, 9178000000, 8369000000, 8338000000, 8374000000, 8371000000, 8311000000,
             8539000000, 8288000000, 8209000000, 8114000000, 7998000000, 7944000000, 7772000000],
            index=q_index
        ),
        lt_invest=pd.Series(
            [105000000, 133000000, 154000000, 160000000, 164000000, 140000000, 123000000, 121000000, 133000000,
             139000000, 124000000, 199000000, 272000000, 270000000, 288000000, 278000000, 272000000, 266000000,
             259000000, 265000000, 257000000, 230000000, 229000000, 231000000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0],
            index=q_index
        ),
        def_tax_lt=pd.Series(
            [3930000000, 3711000000, 3505000000, 3916000000, 3424000000, 3307000000, 3366000000, 1928000000, 3737000000,
             3583000000, 3717000000, 3506000000, 3558000000, 3598000000, 3693000000, 3526000000, 2147000000, 2101000000,
             2200000000, 2131000000, 3143000000, 2780000000, 2914000000, 3005000000, 2489000000, 2486000000, 2536000000,
             2579000000, 2790000000, 2940000000, 2866000000, 2845000000, 1693000000, 1687000000, 1626000000, 1288000000,
             1439000000, 1378000000, 1473000000, 1372000000],
            index=q_index
        ),
        other_lt_assets=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 0, 0],
            index=q_index
        ),
        total_non_current_assets=pd.Series(
            [32821000000, 32424000000, 31417000000, 33065000000, 32210000000, 31779000000, 32856000000, 40903000000,
             43318000000, 43699000000, 44544000000, 45902000000, 46832000000, 46598000000, 46570000000, 47184000000,
             46561000000, 46429000000, 46551000000, 45446000000, 45814000000, 43999000000, 44015000000, 43689000000,
             44834000000, 44559000000, 44694000000, 44403000000, 42737000000, 42001000000, 41519000000, 41375000000,
             40718000000, 40657000000, 40346000000, 39755000000, 39906000000, 39600000000, 39398000000, 38833000000],
            index=q_index
        ),
        total_assets=pd.Series(
            [60038000000, 58836000000, 58793000000, 61642000000, 64020000000, 66387000000, 73611000000, 77767000000,
             81218000000, 83908000000, 88838000000, 90541000000, 88970000000, 88743000000, 87375000000, 87272000000,
             84896000000, 84397000000, 87827000000, 84488000000, 84681000000, 82490000000, 82242000000, 78969000000,
             78342000000, 78307000000, 78300000000, 76402000000, 74704000000, 77549000000, 78510000000, 78560000000,
             76962000000, 78014000000, 78987000000, 78209000000, 78509000000, 78726000000, 79187000000, 77993000000],
            index=q_index
        ),
        payables=pd.Series(
            [2993000000, 3431000000, 3975000000, 4970000000, 5856000000, 5990000000, 6858000000, 7524000000, 8161000000,
             8360000000, 8470000000, 7978000000, 6753000000, 6221000000, 6343000000, 6280000000, 6560000000, 6731000000,
             6860000000, 6778000000, 6515000000, 6328000000, 5862000000, 5206000000, 5023000000, 5101000000, 5104000000,
             4713000000, 4614000000, 5302000000, 5778000000, 6113000000, 6487000000, 6938000000, 6831000000, 6788000000,
             7051000000, 7198000000, 7022000000, 6141000000],
            index=q_index
        ),
        st_debt=pd.Series(
            [9784000000, 8622000000, 8927000000, 8271000000, 7981000000, 9691000000, 8456000000, 7508000000, 9648000000,
             10762000000, 12055000000, 13326000000, 12391000000, 13246000000, 13871000000, 13522000000, 11031000000,
             11290000000, 12936000000, 11102000000, 11501000000, 11972000000, 10875000000, 12335000000, 12844000000,
             13893000000, 14343000000, 13488000000, 13965000000, 14557000000, 13377000000, 11089000000, 11031000000,
             12150000000, 12470000000, 10332000000, 11553000000, 11542000000, 11514000000, 12318000000],
            index=q_index
        ),
        current_lt_debt=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 0, 0],
            index=q_index
        ),
        tax_liab_st=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 0, 0],
            index=q_index
        ),
        other_current_liab=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 0, 0],
            index=q_index
        ),
        total_current_liab=pd.Series(
            [18975000000, 18417000000, 19784000000, 20178000000, 22020000000, 23147000000, 23510000000, 25218000000,
             28357000000, 28849000000, 31273000000, 31746000000, 29415000000, 28974000000, 29919000000, 29119000000,
             27297000000, 27295000000, 29741000000, 27589000000, 27877000000, 26566000000, 25606000000, 25833000000,
             26242000000, 26215000000, 27183000000, 25290000000, 26132000000, 27635000000, 28133000000, 25903000000,
             26931000000, 27402000000, 28300000000, 26033000000, 28218000000, 27388000000, 27735000000, 27201000000],
            index=q_index
        ),
        lt_debt=pd.Series(
            [21847000000, 21548000000, 20226000000, 20337000000, 20437000000, 19895000000, 25926000000, 26781000000,
             24944000000, 25191000000, 27261000000, 26526000000, 27752000000, 27240000000, 25680000000, 26015000000,
             26719000000, 26801000000, 27307000000, 28180000000, 27784000000, 26803000000, 27445000000, 25208000000,
             25169000000, 24470000000, 23980000000, 23622000000, 22818000000, 23725000000, 23815000000, 24835000000,
             23847000000, 23165000000, 23699000000, 25441000000, 25000000000, 24240000000, 24764000000, 25588000000],
            index=q_index
        ),
        total_debt=pd.Series(
            [31631000000, 30170000000, 29153000000, 28608000000, 28418000000, 29586000000, 34382000000, 34289000000,
             34592000000, 35953000000, 39316000000, 39852000000, 40143000000, 40486000000, 39551000000, 39537000000,
             37750000000, 38091000000, 40243000000, 39282000000, 39285000000, 38775000000, 38320000000, 37543000000,
             38013000000, 38363000000, 38323000000, 37110000000, 36783000000, 38282000000, 37192000000, 35924000000,
             34878000000, 35315000000, 36169000000, 35773000000, 36553000000, 35782000000, 36278000000, 37906000000],
            index=q_index
        ),
        deferred_rev=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 0, 0],
            index=q_index
        ),
        tax_liab_lt=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 0, 0],
            index=q_index
        ),
        deposit_liab=pd.Series(
            [1217000000, 1367000000, 1404000000, 1470000000, 1831000000, 1728000000, 1823000000, 2745000000, 2487000000,
             2921000000, 3132000000, 3035000000, 2638000000, 2920000000, 2738000000, 2699000000, 2360000000, 2500000000,
             2344000000, 2165000000, 1697000000, 1636000000, 1754000000, 1610000000, 1146000000, 1328000000, 1259000000,
             1161000000, 1167000000, 1383000000, 1533000000, 1510000000, 1426000000, 1399000000, 1378000000, 1491000000,
             1243000000, 1354000000, 1263000000, 1309000000],
            index=q_index
        ),
        other_lt_liab=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 0, 0],
            index=q_index
        ),
        total_non_current_liab=pd.Series(
            [31763000000, 30945000000, 29305000000, 31132000000, 30675000000, 30109000000, 36205000000, 37845000000,
             39459000000, 39588000000, 41584000000, 40859000000, 41973000000, 41451000000, 39778000000, 39976000000,
             36721000000, 36733000000, 37163000000, 38003000000, 39978000000, 38886000000, 39475000000, 37168000000,
             37215000000, 36339000000, 35814000000, 35397000000, 35359000000, 36254000000, 36298000000, 36960000000,
             36265000000, 35340000000, 35745000000, 36286000000, 36211000000, 35860000000, 36574000000, 35799000000],
            index=q_index
        ),
        total_liab=pd.Series(
            [50738000000, 49362000000, 49089000000, 51310000000, 52695000000, 53256000000, 59715000000, 63063000000,
             67816000000, 68437000000, 72857000000, 72605000000, 71388000000, 70425000000, 69697000000, 69095000000,
             64018000000, 64028000000, 66904000000, 65592000000, 67855000000, 65452000000, 65081000000, 63001000000,
             63457000000, 62554000000, 62997000000, 60687000000, 61491000000, 63889000000, 64431000000, 62863000000,
             63196000000, 62742000000, 64045000000, 62319000000, 64429000000, 63248000000, 64309000000, 63000000000],
            index=q_index
        ),
        common_stock=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 0, 0],
            index=q_index
        ),
        other_income=pd.Series(
            [-3764000000, -3886000000, -4045000000, -4412000000, -4051000000, -3724000000, -3544000000, -4019000000,
             -6328000000, -6033000000, -6150000000, -5988000000, -6433000000, -6669000000, -6698000000, -6247000000,
             -3898000000, -3801000000, -3683000000, -4357000000, -6431000000, -7101000000, -6729000000, -6843000000,
             -2035000000, -1493000000, -1633000000, -1527000000, -2039000000, -1827000000, -1471000000, -1233000000,
             -1192000000, -1016000000, -1496000000, -1568000000, -1684000000, -1588000000, -1499000000, -1783000000],
            index=q_index
        ),
        retained_earnings=pd.Series(
            [19711000000, 19941000000, 20133000000, 20955000000, 21384000000, 22640000000, 23081000000, 24251000000,
             25219000000, 26815000000, 27842000000, 29541000000, 29558000000, 30438000000, 30668000000, 31614000000,
             31854000000, 32775000000, 32961000000, 33977000000, 33887000000, 34998000000, 34823000000, 35191000000,
             29246000000, 29517000000, 29167000000, 29450000000, 27377000000, 27584000000, 27471000000, 28530000000,
             26301000000, 27929000000, 28657000000, 30384000000, 30427000000, 32435000000, 32981000000, 34477000000],
            index=q_index
        ),
        minority_interest=pd.Series(
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 0, 0],
            index=q_index
        ),
        total_equity=pd.Series(
            [8740000000, 8942000000, 9185000000, 9837000000, 10824000000, 12629000000, 13391000000, 14162000000,
             12883000000, 14969000000, 15926000000, 17884000000, 17532000000, 18274000000, 17621000000, 18110000000,
             20811000000, 20305000000, 20856000000, 18823000000, 16746000000, 16962000000, 17092000000, 15896000000,
             14809000000, 15676000000, 15232000000, 15645000000, 13213000000, 13660000000, 14079000000, 15697000000,
             13766000000, 15272000000, 14942000000, 15890000000, 14080000000, 15478000000, 14878000000, 14993000000],
            index=q_index
        ),
        total_liab_and_equity=pd.Series(
            [59478000000.0, 58304000000.0, 58274000000.0, 61147000000.0, 63519000000.0, 65885000000.0, 73106000000.0,
             77225000000.0, 80699000000.0, 83406000000.0, 88783000000.0, 90489000000.0, 88920000000.0, 88699000000.0,
             87318000000.0, 87205000000.0, 84829000000.0, 84333000000.0, 87760000000.0, 84415000000.0, 84601000000.0,
             82414000000.0, 82173000000.0, 78897000000.0, 78266000000.0, 78230000000.0, 78229000000.0, 76332000000.0,
             74704000000.0, 77549000000.0, 78510000000.0, 78560000000.0, 76962000000.0, 78014000000.0, 78987000000.0,
             78209000000.0, 78509000000.0, 78726000000.0, 79187000000.0, 77993000000.0],
            index=q_index
        ),
    )

    def test_annual(self, annual_stockrow_stmts):
        self.check_data_items(annual_stockrow_stmts, self.a_test_data_dict)

    def test_quarterly(self, quarterly_stockrow_stmts: FinancialStatements):
        self.check_data_items(quarterly_stockrow_stmts, self.q_test_data_dict)


class TestLoadCapitalIQ:

    def test_annual(self, annual_capiq_income_df, annual_capiq_bs_df):
        bs = BalanceSheets.from_df(annual_capiq_bs_df)
        inc = IncomeStatements.from_df(annual_capiq_income_df)
        stmts = FinancialStatements(inc, bs)

    def test_quarterly(self, quarterly_capiq_income_df, quarterly_capiq_bs_df):
        bs = BalanceSheets.from_df(quarterly_capiq_bs_df)
        inc = IncomeStatements.from_df(quarterly_capiq_income_df)
        stmts = FinancialStatements(inc, bs)